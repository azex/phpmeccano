<?php

/*
 *     phpMeccano v0.1.0. Web-framework written with php programming language. Maintenance page.
 *     Copyright (C) 2015-2016  Alexei Muzarov
 * 
 *     This program is free software; you can redistribute it and/or modify
 *     it under the terms of the GNU General Public License as published by
 *     the Free Software Foundation; either version 2 of the License, or
 *     (at your option) any later version.
 * 
 *     This program is distributed in the hope that it will be useful,
 *     but WITHOUT ANY WARRANTY; without even the implied warranty of
 *     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 *     GNU General Public License for more details.
 * 
 *     You should have received a copy of the GNU General Public License along
 *     with this program; if not, write to the Free Software Foundation, Inc.,
 *     51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.
 * 
 *     e-mail: azexmail@gmail.com
 *     e-mail: azexmail@mail.ru
 *     https://bitbucket.org/azexmail/phpmeccano
 */

if (defined('MECCANO_SERVICE_PAGES')) {
    $confPath = MECCANO_SERVICE_PAGES.'/maintenance.json';
}
else {
    $confPath = 'maintenance.json';
}

if (!is_file($confPath) || !is_readable($confPath)) {
    $timeout = 1800;
    $prmsg = 'The site is under maintenance';
    $secmsg = 'Please, be patient';
}
else {
    $conf = json_decode(file_get_contents($confPath));
    $prmsg = htmlspecialchars($conf->prmsg);
    $secmsg = htmlspecialchars($conf->secmsg);
    if ($conf->timeout) {
        $timeout = gmdate('D, d M Y H:i:s T', $conf->startpoint + $conf->timeout);
    }
    else {
        $timeout = 1800;
    }
}

http_response_code(503);
header("Retry-After: $timeout");
header('Content-Type: text/html; charset=utf-8');

?>

<!DOCTYPE html> 
<html> 
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <title>The site is under maintenance</title>
        <style>
            h1 {text-align: center;}
            h2, h3 {
                text-align: center;
                font-weight: normal;
            }
            p {text-align: center;}
        </style>
    </head>
    <body>
        <h1>503 Service Unavailable</h1>
        <p>
            <svg
    xmlns:dc="http://purl.org/dc/elements/1.1/"
    xmlns:cc="http://creativecommons.org/ns#"
    xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
    xmlns:svg="http://www.w3.org/2000/svg"
    xmlns="http://www.w3.org/2000/svg"
    xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd"
    xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"
    id="svg842"
    version="1.1"
    viewBox="0 0 71.529205 61.680278"
    height="61.680279mm"
    width="71.529205mm"
    sodipodi:docname="maintenance.svg"
    inkscape:version="0.92.4 (unknown)">
    <sodipodi:namedview
        pagecolor="#ffffff"
        bordercolor="#666666"
        borderopacity="1"
        objecttolerance="10"
        gridtolerance="10"
        guidetolerance="10"
        inkscape:pageopacity="0"
        inkscape:pageshadow="2"
        inkscape:window-width="1366"
        inkscape:window-height="701"
        id="namedview17"
        showgrid="false"
        inkscape:zoom="1.4316708"
        inkscape:cx="58.447672"
        inkscape:cy="73.546927"
        inkscape:window-x="0"
        inkscape:window-y="0"
        inkscape:window-maximized="1"
        inkscape:current-layer="svg842" />
    <defs
        id="defs836" />
    <metadata
        id="metadata839">
        <rdf:RDF>
            <cc:Work
                rdf:about="">
                <dc:format>image/svg+xml</dc:format>
                <dc:type
                    rdf:resource="http://purl.org/dc/dcmitype/StillImage" />
                <dc:title />
            </cc:Work>
        </rdf:RDF>
    </metadata>
    <path
        style="color:#000000;clip-rule:nonzero;display:inline;overflow:visible;visibility:visible;opacity:1;isolation:auto;mix-blend-mode:normal;color-interpolation:sRGB;color-interpolation-filters:linearRGB;solid-color:#000000;solid-opacity:1;fill:none;fill-opacity:1;fill-rule:nonzero;stroke:#000000;stroke-width:0.99999994;stroke-linecap:butt;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1;marker:none;color-rendering:auto;image-rendering:auto;shape-rendering:auto;text-rendering:auto;enable-background:accumulate"
        d="M 51.076172 126.62109 L 47.796875 133.86523 L 47.796875 138.45312 L 48.164062 140.94922 L 47.796875 141.04688 L 47.796875 150.31445 C 49.55584 149.93852 51.377597 149.73242 53.25 149.73242 C 62.68869 149.73242 70.941031 154.75798 75.451172 162.29492 A 1.5001499 1.5001499 0 1 1 72.876953 163.83398 C 68.891634 157.17409 61.625811 152.73242 53.25 152.73242 C 50.905742 152.73242 48.653795 153.09311 46.53125 153.74023 C 45.616496 154.77456 44.292594 155.4375 42.796875 155.4375 C 42.687193 155.4375 42.58054 155.42876 42.472656 155.42188 C 38.812478 157.37456 35.749805 160.28326 33.625 163.83398 A 1.5001499 1.5001499 0 1 1 31.050781 162.29492 C 33.079786 158.90428 35.870922 156.03003 39.181641 153.88477 C 38.327066 152.98845 37.796875 151.77942 37.796875 150.4375 L 37.796875 137.64844 L 37.171875 136.77344 L 30.646484 132.09375 L 26.882812 134.26758 L 27.671875 142.25781 L 28.75 144.62891 L 31.523438 148.13477 L 25.792969 153.86523 L 22.289062 151.0918 L 19.916016 150.01367 L 11.925781 149.22461 L 9.7539062 152.98828 L 14.431641 159.51172 L 16.550781 161.02734 L 20.705078 162.67578 L 18.607422 170.50391 L 14.185547 169.85547 L 11.59375 170.10742 L 4.2792969 173.41797 L 4.2792969 177.76562 L 11.59375 181.07617 L 14.185547 181.32812 L 18.607422 180.67969 L 20.705078 188.50781 L 16.550781 190.15625 L 14.431641 191.67188 L 9.7539062 198.19531 L 11.925781 201.95898 L 19.916016 201.16992 L 22.289062 200.0918 L 25.792969 197.31836 L 31.523438 203.04883 L 28.75 206.55469 L 27.671875 208.92578 L 26.882812 216.91602 L 30.646484 219.08984 L 37.171875 214.41016 L 38.685547 212.29102 L 40.333984 208.13672 L 48.164062 210.23438 L 47.513672 214.65625 L 47.765625 217.25 L 51.076172 224.5625 L 55.423828 224.5625 L 58.734375 217.25 L 58.986328 214.65625 L 58.337891 210.23438 L 66.166016 208.13672 L 67.814453 212.29102 L 69.330078 214.41016 L 75.853516 219.08984 L 79.619141 216.91602 L 78.828125 208.92578 L 77.75 206.55469 L 74.976562 203.04883 L 80.708984 197.31836 L 84.212891 200.0918 L 86.583984 201.16992 L 94.574219 201.95898 L 96.748047 198.19531 L 92.068359 191.67188 L 89.949219 190.15625 L 85.794922 188.50781 L 87.025391 183.91406 L 80.757812 180.81836 L 81.960938 176.61328 L 78.912109 171.99609 L 79.869141 163.97461 L 78.974609 157.74414 L 75.59375 158.64844 L 70.992188 148.23633 L 60.582031 142.22461 L 60.695312 141.58008 L 58.337891 140.94922 L 58.986328 136.52734 L 58.734375 133.93359 L 55.423828 126.62109 L 51.076172 126.62109 z M 126.67578 127.72656 L 122.47656 128.85156 L 121.17188 136.77344 L 121.59961 139.34375 L 123.37109 143.44727 L 116.35156 147.49805 L 113.68359 143.91406 L 111.67188 142.25781 L 104.1582 139.42773 L 101.08594 142.5 L 103.91602 150.01367 L 105.57227 152.02539 L 109.15625 154.69336 L 105.10547 161.71094 L 101.00195 159.93945 L 98.431641 159.51172 L 90.509766 160.81836 L 89.384766 165.01562 L 95.59375 170.10742 L 98.033203 171.02148 L 102.4707 171.53906 L 102.4707 179.64453 L 98.033203 180.16211 L 95.59375 181.07617 L 89.384766 186.16797 L 90.509766 190.36523 L 98.431641 191.67188 L 101.00195 191.24414 L 105.10547 189.47266 L 109.15625 196.49023 L 105.57227 199.1582 L 103.91602 201.16992 L 101.08594 208.68359 L 104.1582 211.75586 L 111.67188 208.92578 L 113.68359 207.26953 L 116.35156 203.68555 L 123.37109 207.73633 L 121.59961 211.83984 L 121.17188 214.41016 L 122.47656 222.33203 L 126.67578 223.45703 L 131.76562 217.25 L 132.68164 214.80859 L 133.19727 210.37109 L 141.30273 210.37109 L 141.82031 214.80859 L 142.73438 217.25 L 147.82617 223.45703 L 152.02344 222.33203 L 153.33008 214.41016 L 152.90234 211.83984 L 151.13086 207.73633 L 158.14844 203.68555 L 160.81641 207.26953 L 162.82812 208.92578 L 170.3418 211.75586 L 173.41602 208.68359 L 170.58398 201.16992 L 168.92969 199.1582 L 165.34375 196.49023 L 169.39648 189.47266 L 173.49805 191.24414 L 176.06836 191.67188 L 183.99023 190.36523 L 185.11523 186.16797 L 178.9082 181.07617 L 176.46875 180.16211 L 172.0293 179.64453 L 172.0293 171.53906 L 176.46875 171.02148 L 178.9082 170.10742 L 185.11523 165.01562 L 183.99023 160.81836 L 176.06836 159.51172 L 173.49805 159.93945 L 169.39648 161.71094 L 165.34375 154.69336 L 168.92969 152.02539 L 170.58398 150.01367 L 173.41602 142.5 L 170.3418 139.42773 L 162.82812 142.25781 L 160.81641 143.91406 L 158.14844 147.49805 L 151.13086 143.44727 L 152.90234 139.34375 L 153.33008 136.77344 L 152.02344 128.85156 L 147.82617 127.72656 L 142.73438 133.93359 L 141.82031 136.375 L 141.30273 140.8125 L 133.19727 140.8125 L 132.68164 136.375 L 131.76562 133.93359 L 126.67578 127.72656 z M 136.83398 149.7168 A 1.5001833 1.5001833 0 1 1 136.88086 152.7168 C 129.12039 152.8385 121.64099 156.90851 117.45312 164.16211 C 113.26519 171.41578 113.4809 179.92764 117.25586 186.70898 A 1.5003766 1.5003766 0 0 1 114.63477 188.16992 C 110.36269 180.49555 110.13613 170.83624 114.85547 162.66211 C 119.57478 154.48797 128.052 149.85428 136.83398 149.7168 z M 53.248047 161.5918 C 60.962255 161.5918 67.251953 167.87368 67.251953 175.58789 C 67.251976 183.30213 60.962278 189.5918 53.248047 189.5918 C 45.533808 189.5918 39.251934 183.30213 39.251953 175.58789 C 39.251964 167.87368 45.533827 161.5918 53.248047 161.5918 z M 137.73438 161.60156 C 138.77534 161.63669 139.82715 161.78761 140.875 162.06836 C 148.32638 164.06497 152.76807 171.76545 150.77148 179.2168 C 148.77487 186.66817 141.08024 191.11182 133.62891 189.11523 C 126.17753 187.11863 121.728 179.42208 123.72461 171.9707 C 125.34683 165.91646 130.73661 161.84637 136.69727 161.60352 C 137.04115 161.58951 137.38739 161.58985 137.73438 161.60156 z M 158.51172 162.22656 A 1.5001499 1.5001499 0 0 1 159.86719 163.01562 C 164.13911 170.68981 164.36585 180.34738 159.64648 188.52148 C 154.92714 196.69562 146.44824 201.32937 137.66602 201.4668 A 1.5001833 1.5001833 0 0 1 137.61914 198.4668 C 145.37942 198.34547 152.85892 194.2752 157.04688 187.02148 C 161.23474 179.76789 161.02112 171.25614 157.24609 164.47461 A 1.5001499 1.5001499 0 0 1 158.51172 162.22656 z M 53.248047 164.58984 C 47.155146 164.58984 42.25 169.49503 42.25 175.58789 C 42.249981 181.68083 47.155127 186.59375 53.248047 186.59375 C 59.340955 186.59375 64.248054 181.68083 64.248047 175.58789 C 64.248036 169.49503 59.340936 164.58984 53.248047 164.58984 z M 136.80664 164.5918 C 132.1151 164.77416 127.90235 167.96432 126.62109 172.74609 C 125.04412 178.63138 128.51901 184.64178 134.4043 186.21875 C 140.28959 187.79572 146.29803 184.32671 147.875 178.44141 C 149.45193 172.55612 145.9849 166.53986 140.09961 164.96289 C 138.99612 164.66722 137.8893 164.54973 136.80664 164.5918 z M 74.240234 186.58594 A 1.5001499 1.5001499 0 0 1 75.451172 188.88867 C 70.941035 196.42558 62.68869 201.45117 53.25 201.45117 C 43.811348 201.45117 35.560831 196.42535 31.050781 188.88867 A 1.5001499 1.5001499 0 0 1 32.396484 186.60156 A 1.5001499 1.5001499 0 0 1 33.625 187.34961 C 37.61045 194.00963 44.874238 198.45117 53.25 198.45117 C 61.625811 198.45117 68.891623 194.00948 72.876953 187.34961 A 1.5001499 1.5001499 0 0 1 74.240234 186.58594 z "
        transform="scale(0.26458334)"
        id="path5786" />
    <path
        id="rect824"
        transform="scale(-1,1)"
        style="fill:none;fill-opacity:1;stroke:#000000;stroke-width:0.26458332;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"
        d="m -63.782468,42.027275 c 2.931583,0 5.291666,2.360083 5.291666,5.291667 0,2.931583 -2.360083,5.291666 -5.291666,5.291666 -2.931584,0 -5.291667,-2.360083 -5.291667,-5.291666 0,-2.931584 2.360083,-5.291667 5.291667,-5.291667 z M -51.456017,1.3150188 c 2.831691,0.7587495 4.500522,3.6492491 3.741772,6.4809408 -0.758749,2.8316924 -3.649249,4.5005234 -6.480941,3.7417734 -2.831692,-0.758749 -4.500523,-3.6492489 -3.741773,-6.4809416 0.758749,-2.8316917 3.649249,-4.50052243 6.480942,-3.7417726 z m -6.604524,5.8953939 c 0.300154,2.020342 1.760278,3.7633193 3.865398,4.3273843 0.741175,0.198597 1.485554,0.227382 2.195214,0.115756 -0.01355,0.0021 -0.02673,0.0057 -0.04031,0.0078 0.855835,1.361294 2.208901,2.415573 3.891751,2.866492 l -7.532873,28.111979 c -0.451077,1.683448 -1.505529,3.037001 -2.867525,3.892785 -0.377695,-2.555973 -2.569562,-4.50515 -5.233789,-4.50515 -1.681366,0 -3.171849,0.778446 -4.139798,1.993678 -0.751612,-1.422123 -0.987994,-3.121443 -0.536919,-4.804876 l 7.532357,-28.112497 c 0.451022,-1.6832426 1.504709,-3.037481 2.866491,-3.8933023 z m 9.343618,2.5512655 c -0.05814,0.071724 -0.118253,0.141518 -0.179835,0.2098064 0.06156,-0.068347 0.121703,-0.1380334 0.179835,-0.2098064 z m -0.252183,0.2888718 c -0.06103,0.06496 -0.123531,0.128048 -0.187584,0.189652 0.06392,-0.06158 0.126672,-0.12473 0.187584,-0.189652 z m -0.273883,0.270784 c -0.06403,0.05886 -0.129133,0.116047 -0.195855,0.171566 0.06663,-0.05556 0.131908,-0.112674 0.195855,-0.171566 z m -0.285255,0.24443 c -0.06627,0.05274 -0.133414,0.104043 -0.202055,0.153479 0.06859,-0.04951 0.135837,-0.100674 0.202055,-0.153479 z m -0.313677,0.232027 c -0.06219,0.0424 -0.12522,0.0833 -0.189135,0.12299 0.0638,-0.03972 0.127056,-0.08057 0.189135,-0.12299 z m -0.331245,0.208256 c -0.05627,0.03255 -0.113094,0.06411 -0.170532,0.09457 0.05742,-0.03054 0.114281,-0.06194 0.170532,-0.09457 z m -0.346231,0.183968 c -0.0494,0.02389 -0.0992,0.04689 -0.149347,0.06925 0.05013,-0.02241 0.09996,-0.0453 0.149347,-0.06925 z m -0.358635,0.157613 c -0.042,0.0166 -0.08416,0.03253 -0.126609,0.04806 0.04237,-0.01555 0.08469,-0.03144 0.126609,-0.04806 z m -0.364837,0.129191 c -0.03861,0.01207 -0.07735,0.02343 -0.116271,0.03462 0.03886,-0.01122 0.07772,-0.02253 0.116271,-0.03462 z m -0.373102,0.101803 c -0.03353,0.0078 -0.06705,0.01554 -0.100769,0.02274 0.03373,-0.0072 0.06723,-0.01486 0.100769,-0.02274 z m 34.569868,4.434844 c -0.75875,2.831692 -3.649249,4.500523 -6.480941,3.741773 -2.831692,-0.758749 -4.500523,-3.649249 -3.741774,-6.480942 0.75875,-2.831691 3.64925,-4.5005218 6.480942,-3.7417723 2.831692,0.7587493 4.500523,3.6492493 3.741773,6.4809413 z M -46.378565,1.5208374 c 0.546209,0.00606 1.101098,0.080217 1.654162,0.2284099 l 17.889863,4.7935061 c 1.68307,0.4509764 3.036449,1.5049122 3.89227,2.8664916 -2.020068,0.3003685 -3.762346,1.759983 -4.32635,3.864881 -0.563984,2.104815 0.214722,4.240595 1.813842,5.510774 -1.421918,0.751133 -3.120866,0.987354 -4.803841,0.536402 l -17.889866,-4.793506 c -1.68285,-0.450919 -3.035916,-1.505198 -3.891751,-2.866492 2.019856,-0.300537 3.761875,-1.7606751 4.325835,-3.8653972 0.563951,-2.104699 -0.214903,-4.2400533 -1.813843,-5.5102581 0.954632,-0.5043066 2.033756,-0.7771842 3.149679,-0.7648113 z m 24.434684,32.5716576 c 0.05972,0.06695 0.114008,0.140795 0.160714,0.221691 l 2.92747,5.070491 -1.14515,2.591057 -0.490409,-0.13126 -3.583761,-6.207371 c -0.07968,-0.138001 -0.12667,-0.284617 -0.152962,-0.432533 0.149874,0.134075 0.328667,0.239789 0.536918,0.29559 0.707923,0.189688 1.430886,-0.22742 1.620573,-0.935344 z m 3.934127,6.757209 0.195337,0.338482 c 0.0723,0.125219 0.115445,0.257842 0.143661,0.391705 -0.585411,0.429871 -1.088675,0.963054 -1.486215,1.573033 -0.266585,-0.0402 -0.51602,-0.160719 -0.715718,-0.352952 0.485576,-0.767948 1.11947,-1.430745 1.862935,-1.950268 z m 7.925615,-9.4356 c 0.05135,0.141441 0.08372,0.292037 0.08372,0.451652 v 7.9375 c 0,0.732896 -0.590021,1.322917 -1.322917,1.322917 -0.732896,0 -1.322917,-0.590021 -1.322917,-1.322917 v -7.9375 c 0,-0.09351 0.01014,-0.184404 0.02842,-0.272336 l 0.345716,0.345716 c 0.518235,0.518236 1.352451,0.518236 1.870686,0 0.15252,-0.15252 0.254549,-0.333883 0.317294,-0.525032 z m -11.91917,-5.971729 0.02946,0.109038 c 0.249512,0.931191 0.961006,1.607993 1.821077,1.856217 l -1.917712,7.157186 c -0.189687,0.707924 -0.91265,1.125032 -1.620573,0.935344 -0.707923,-0.189688 -1.125031,-0.912132 -0.935343,-1.620057 l 2.054655,-7.667232 c 0.08944,-0.33378 0.299457,-0.599111 0.56844,-0.770496 z m 5.111316,-1.369425 c 0.318687,0.0139 0.633604,0.138543 0.877983,0.382922 l 5.612577,5.612577 c 0.5182361,0.518237 0.5182361,1.352452 0,1.870687 -0.518235,0.518236 -1.352451,0.518236 -1.870686,0 l -5.239474,-5.239473 c 0.620671,-0.644929 0.898582,-1.586434 0.649056,-2.517676 z m -1.523421,-5.688025 1.552877,5.797062 c 0.379375,1.415846 -0.454841,2.860738 -1.870687,3.240113 -1.415846,0.379375 -2.861254,-0.454843 -3.240629,-1.870687 l -1.553394,-5.796029 c 1.898614,0.508732 3.820622,-0.07775 5.111833,-1.370459 z m -40.513807,31.047202 c 1.093483,1.179017 1.761649,2.759244 1.761649,4.501533 v 6.614584 H -70.396739 V 53.93366 c 0,-1.742289 0.667649,-3.322516 1.761132,-4.501533 0.81302,1.873374 2.673874,3.178617 4.852935,3.178617 2.179064,0 4.040434,-1.305243 4.853451,-3.178617 z" />
</svg>
        </p>
        <h2><?php echo $prmsg; ?></h2>
        <h3><?php echo $secmsg; ?></h3>
    </body>
</html>
